<!doctype html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å®ç°è¿·ä½ SSR - ç»„ä»¶æœåŠ¡ç«¯æ¸²æŸ“</title>
    <script type="module" crossorigin src="/21081715/dist/assets/index-MQVGeJDe.js"></script>
    <script type="module" crossorigin src="/21081715/dist/assets/index-A_9H3jJA.js"></script>
    <link rel="stylesheet" crossorigin href="/21081715/dist/assets/index-FnwD_uIS.css">
    <link rel="stylesheet" crossorigin href="/21081715/dist/assets/index-FJxq1wWu.css">
  </head>
  <body class="flex flex-col h-100vh overflow-hidden">
    <header-bar></header-bar>

    <div class="pt-4 flex flex-col flex-1 overflow-auto scrollbar-slim gap-4">
      <div class="flex">
        <aside class="hidden lg:block basis-72 pl-2">
          <h2 class="text-lg">æœ€æ–°è¯„è®º</h2>

          <div class="flex gap-2 items-start">
            <!-- <div class="pa-1 bg-lime-2 border-1 border-solid rounded-full">
              <i class="i-uil-0-plus text-lg"></i>
            </div>
            <p class="my-0 bg-primary-2 dark:bg-primary-7 rounded-lg pa-2">
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Ut eius repellendus molestiae
              quia?
            </p> -->
          </div>
        </aside>
        <main class="md:mx-4 flex-1 rounded-xl overflow-hidden">
          <header>
            <h1 class="text-center">Titleå®ç°è¿·ä½ SSR - ç»„ä»¶æœåŠ¡ç«¯æ¸²æŸ“</h1>
          </header>
          <article
            class="markdown-article bg-primary-2 pa-4 rounded-xl dark:bg-primary-7 line-height-6"
          >
            <p class="paragraph"><img src="https://img.shields.io/badge/docs-%F0%9F%90%A4_%E8%AF%AD%E9%9B%80-%2328BE5E#from=url&id=Gz3J1&originHeight=20&originWidth=82&originalType=binary&ratio=1.25&rotation=0&showTitle=false&status=done&style=none&title=" alt=""></p><p class="paragraph">ç”±äº<code class="inline-code">Nuxtjs</code>ç­‰å…ƒæ¡†æ¶çš„ä½¿ç”¨ï¼Œä¸€ç›´å¥½å¥‡äº<code class="inline-code">SSR</code>çš„å®ç°åŸç†ï¼Œæ‰€ä»¥å†³å®šä½¿ç”¨æœ€å°‘çš„ä¾èµ–ï¼ˆæ’é›·ï¼šæ— <del>Express</del>ï¼Œäº†è§£<code class="inline-code">h</code>å‡½æ•°çš„ä½¿ç”¨ï¼‰å°è¯•å®ç°ä¸€ä¸‹<code class="inline-code">Vue3</code>çš„æœåŠ¡ç«¯æ¸²æŸ“ã€‚<br /><code class="inline-code">Node.js 21.1.0</code>æ›´æ–°äº†<code class="inline-code">ESM</code>çš„åˆ¤æ–­è§„åˆ™ï¼Œå¯ä»¥ç›´æ¥å¼•å…¥<code class="inline-code">ESM</code>è€Œä¸éœ€è¦æ·»åŠ çƒ¦äººçš„<code class="inline-code">.js</code>åç¼€äº†(æ‰‹é‡Œçš„<code class="inline-code">Node 20</code>æ‰ç”¨å‡ å¤©å°±ä¸é¦™äº†)ï¼Œè‹¥ä½¿ç”¨<code class="inline-code">Node.js 21+</code>ä¸‹æ–‡çš„<code class="inline-code">entry-server.js</code>å¯ä»¥å°è¯•ä¿®æ”¹ä¸€ä¸‹å®ç°ä¸æ‰“åŒ…è€Œç›´æ¥è¿è¡Œäº†å¹¶ä¸”å¯ä»¥ä½¿ç”¨ node è‡ªå¸¦çš„ <code class="inline-code">watch</code> å‘½ä»¤ï¼Œå‰ææ˜¯ä¸ä½¿ç”¨ SFC ã€‚</p><ul>
<li><code class="inline-code">Node.js &gt;= 18.0.0</code>(æ”¯æŒ<code class="inline-code">fetch API</code>)</li>
<li><code class="inline-code">Vue &gt;= 3.2</code></li>
<li><code class="inline-code">VueRouter &gt;= 4.0</code></li>
<li><code class="inline-code">Pinia &gt;= 2.0</code>
<a name="qhqMG"></a></li>
</ul>

          <h2 id="%E7%9B%AE%E6%A0%87%E6%B8%85%E5%8D%95" class="header h2">
            <a name="ç›®æ ‡æ¸…å•" data-level="2" class="anchor" href="#%E7%9B%AE%E6%A0%87%E6%B8%85%E5%8D%95">
              <span class="header-link">#</span>
            </a>
            ç›®æ ‡æ¸…å•
          </h2><ul>
<li>âœ… <a href="https://github.com/Jon-a-than/vue3-ssr-mini/tree/v0.0.1" title="null" class="link">ç»„ä»¶æ¸²æŸ“</a></li>
<li>âœ… <a href="https://github.com/Jon-a-than/vue3-ssr-mini/tree/v0.0.2" title="null" class="link">è·¯ç”±åŠŸèƒ½</a></li>
<li>âœ… <a href="https://github.com/Jon-a-than/vue3-ssr-mini/tree/v0.0.3" title="null" class="link">çŠ¶æ€ç®¡ç†</a></li>
<li>âœ… æ•°æ®é¢„å–</li>
<li>ğŸš§ éƒ¨åˆ†é¢„æ¸²æŸ“
<a name="g0xKM"></a></li>
</ul>

          <h2 id="%E4%BE%9D%E8%B5%96" class="header h2">
            <a name="ä¾èµ–" data-level="2" class="anchor" href="#%E4%BE%9D%E8%B5%96">
              <span class="header-link">#</span>
            </a>
            ä¾èµ–
          </h2><p class="paragraph"><code class="inline-code">Vue3</code>æœåŠ¡ç«¯æ¸²æŸ“æœ€é‡è¦çš„ä¾èµ–æ˜¯<code class="inline-code">vue</code>ä¸<code class="inline-code">@vue/server-renderer</code>,<code class="inline-code">@vue/server-renderer</code>ç”¨äºå°†ç»„ä»¶åœ¨æœåŠ¡ç«¯æ¸²æŸ“ä¸º<code class="inline-code">html</code>å­—ç¬¦ä¸²ï¼Œä»è€Œæ‹¼æ¥åˆ°<code class="inline-code">html</code>ä¸­ï¼Œä¸è¿‡<code class="inline-code">@vue/server-renderer</code>å·²ç»åœ¨<code class="inline-code">vue</code>åŒ…ä¸­å†…ç½®äº†æ‰€ä»¥ä¸å¿…å•ç‹¬å®‰è£… :pã€‚</p><pre><code class="language-bash"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #FFCB6B">pnpm</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">i</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">vue</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">-P</span></span></code></pre>
</code></pre><p class="paragraph"><a name="dVRRD"></a></p>
          <h2 id="Node.js%E6%B8%B2%E6%9F%93Vue%E7%BB%84%E4%BB%B6" class="header h2">
            <a name="Node.jsæ¸²æŸ“Vueç»„ä»¶" data-level="2" class="anchor" href="#Node.js%E6%B8%B2%E6%9F%93Vue%E7%BB%84%E4%BB%B6">
              <span class="header-link">#</span>
            </a>
            Node.jsæ¸²æŸ“Vueç»„ä»¶
          </h2><p class="paragraph"><a name="gOCmA"></a></p>
          <h3 id="%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93" class="header h3">
            <a name="ç»„ä»¶æ¸²æŸ“" data-level="3" class="anchor" href="#%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93">
              <span class="header-link">#</span>
            </a>
            ç»„ä»¶æ¸²æŸ“
          </h3><p class="paragraph">æ—¢ç„¶è¦æœ€ç®€å®ç°ï¼Œæ‰€ä»¥ä½¿ç”¨<code class="inline-code">h</code>å‡½æ•°æ¥åˆ›å»º<code class="inline-code">Vue</code>ç»„ä»¶è€Œå¹¶ä¸æ˜¯å•æ–‡ä»¶ç»„ä»¶ã€‚<br />å…ˆåˆ›å»º<code class="inline-code">entry-server.js</code>(è¯¥æ–‡ä»¶åå·²æˆçº¦å®š)æ¥çœ‹çœ‹<code class="inline-code">renderToString</code>è¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½ã€‚</p><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">h</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">vue</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">renderToString</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">vue/server-renderer</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> app </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">h</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">h1</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">Hello world!</span><span style="color: #89DDFF">&#39;</span><span style="color: #EEFFFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> AppString </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">renderToString</span><span style="color: #EEFFFF">(app)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">log</span><span style="color: #EEFFFF">(AppString) </span><span style="color: #546E7A; font-style: italic">// &lt;h1&gt;Hello World!&lt;/h1&gt;</span></span></code></pre>
</code></pre><p class="paragraph"><code class="inline-code">package.json</code>ç¼–å†™ä¸€ä¸‹è¿è¡Œè„šæœ¬, æ‰§è¡Œ<code class="inline-code">pnpm dev:server</code>å³å¯çœ‹åˆ°<code class="inline-code">&lt;h1&gt;Hello World!&lt;/h1&gt;</code>çš„ç»“æœã€‚è¿™ä¹ˆç¥å¥‡! é‚£æˆ‘ä»¬æŠŠå­—ç¬¦ä¸²æ’å…¥åˆ°<code class="inline-code">HTML</code>æ¨¡æ¿ä¸­å²‚ä¸å°±å®Œæˆäº†æœåŠ¡ç«¯æ¸²æŸ“ï¼Œé¡µé¢é™æ€ç”Ÿæˆå¥½åƒä¹Ÿæ˜¯ä¸€æ­¥ä¹‹é¥ã€‚</p><pre><code class="language-json"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">type</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">module</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">scripts</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">dev:server</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">node ./src/entry-server.js</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">dependencies</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">vue</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">^3.3.7</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">:::success
ç”±äºä½¿ç”¨çš„æ˜¯<code class="inline-code">ESM</code>ï¼Œè¦è®°å¾—åœ¨<code class="inline-code">package.json</code>ä¸­æ·»åŠ <code class="inline-code">&quot;type&quot;: &quot;module&quot;</code>
:::</p><p class="paragraph"><a name="vhAj2"></a></p>
          <h3 id="%E6%8B%BC%E6%8E%A5HTML%E9%A1%B5%E9%9D%A2" class="header h3">
            <a name="æ‹¼æ¥HTMLé¡µé¢" data-level="3" class="anchor" href="#%E6%8B%BC%E6%8E%A5HTML%E9%A1%B5%E9%9D%A2">
              <span class="header-link">#</span>
            </a>
            æ‹¼æ¥HTMLé¡µé¢
          </h3><p class="paragraph">å…ˆåœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª<code class="inline-code">index.html</code>æ–‡ä»¶ä½œä¸ºé¡µé¢æ¨¡æ¿, ä½¿ç”¨<code class="inline-code">&lt;!-- App Slot --&gt;</code>ä½œä¸ºå ä½å­—ç¬¦ä¸²ï¼Œå¾…ä¼šå„¿å°±æŠŠå®ƒæ›¿æ¢ä¸ºç»„ä»¶çš„<code class="inline-code">html</code>å­—ç¬¦ä¸²ã€‚</p><pre><code class="language-html"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF">&lt;!</span><span style="color: #F07178">DOCTYPE</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">html</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">html</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">lang</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">zh</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">head</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">meta</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">charset</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">UTF-8</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> /&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">meta</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">name</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">viewport</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">content</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">width=device-width, initial-scale=1.0</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> /&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">title</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">Mini SSR</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">title</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">head</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">div</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">id</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">app</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span><span style="color: #546E7A; font-style: italic">&lt;!-- App Slot --&gt;</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">div</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">html</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">ç”±äºè¦å†™<code class="inline-code">node.js</code>ï¼Œæ‰€ä»¥æœ€å¥½ä¹Ÿå®‰è£…ä¸€ä¸‹<code class="inline-code">@types/node</code>ä»¥å¢å¼ºç±»å‹æç¤º(éå¿…è¦)ã€‚</p><pre><code class="language-bash"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #FFCB6B">pnpm</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">i</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">@types/node</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">-D</span></span></code></pre>
</code></pre><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">h</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">vue</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">renderToString</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">vue/server-renderer</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">readFile</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:fs/promises</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">fileURLToPath</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:url</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> component </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">h</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">h1</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">Hello World!</span><span style="color: #89DDFF">&#39;</span><span style="color: #EEFFFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">log</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">render</span><span style="color: #EEFFFF">(component))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">/**</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic"> * </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">param</span><span style="color: #546E7A; font-style: italic"> </span><span style="color: #89DDFF; font-style: italic">{</span><span style="color: #FFCB6B; font-style: italic">import(&#39;vue&#39;).App&lt;any&gt; | import(&#39;vue&#39;).VNode</span><span style="color: #89DDFF; font-style: italic">}</span><span style="color: #546E7A; font-style: italic"> </span><span style="color: #EEFFFF; font-style: italic">root</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic"> * </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">returns</span><span style="color: #546E7A; font-style: italic"> </span><span style="color: #89DDFF; font-style: italic">{</span><span style="color: #FFCB6B; font-style: italic">Promise&lt;string&gt;</span><span style="color: #89DDFF; font-style: italic">}</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic"> */</span></span>
<span class="line"><span style="color: #C792EA">async</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">render</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">root</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">TemplatePath</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">fileURLToPath</span><span style="color: #F07178">(</span><span style="color: #89DDFF">new</span><span style="color: #F07178"> </span><span style="color: #82AAFF">URL</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">../index.html</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">meta</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">url</span><span style="color: #F07178">))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">template</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #F07178"> </span><span style="color: #82AAFF">readFile</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">TemplatePath</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> encoding</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">utf-8</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">app</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #F07178"> </span><span style="color: #82AAFF">renderToString</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">root</span><span style="color: #F07178">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">template</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">replace</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">&lt;!-- App Slot --&gt;</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">app</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph"><code class="inline-code">pnpm dev:server</code>è¿è¡Œåå¾—åˆ°è¾“å‡º,ã€‚</p><pre><code class="language-html"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF">&lt;!</span><span style="color: #F07178">DOCTYPE</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">html</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">html</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">lang</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">zh</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">head</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">meta</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">charset</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">UTF-8</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> /&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">meta</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">name</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">viewport</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">content</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">width=device-width, initial-scale=1.0</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> /&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">title</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">Mini SSR</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">title</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">head</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">div</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">id</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">app</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;&lt;</span><span style="color: #F07178">h1</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">Hello World!</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">h1</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #F07178">div</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">html</span><span style="color: #89DDFF">&gt;</span></span></code></pre>
</code></pre><p class="paragraph"><a name="WHDHK"></a></p>
          <h2 id="%E6%9E%84%E5%BB%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF" class="header h2">
            <a name="æ„å»ºæœåŠ¡ç«¯" data-level="2" class="anchor" href="#%E6%9E%84%E5%BB%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF">
              <span class="header-link">#</span>
            </a>
            æ„å»ºæœåŠ¡ç«¯
          </h2><p class="paragraph">åœ¨<code class="inline-code">entry-server.js</code>ä¸­å¯åŠ¨ä¸€ä¸ª<code class="inline-code">node</code>æœåŠ¡å™¨ï¼Œç”¨äºå“åº”è¯·æ±‚ã€‚<br />æœåŠ¡ç«¯å¼€å¯åè¿”å›æ‹¼æ¥åçš„<code class="inline-code">html</code>é¡µé¢, ç›´æ¥<code class="inline-code">curl localhost:4936</code>åè¿”å›äº†æ‹¼æ¥åçš„<code class="inline-code">html</code>é¡µé¢ï¼Œè‡³æ­¤å°±å®ç°äº†æœåŠ¡ç«¯æ¸²æŸ“åŠŸèƒ½ã€‚è¿™é‡Œçš„<code class="inline-code">render</code>å‡½æ•°ä¸­è¯»å–<code class="inline-code">index.html</code>çš„æ­¥éª¤å¯ä»¥å°†å…¶æ”¹ä¸ºå…¨å±€å¸¸é‡ï¼Œè¿™æ ·å°±ä¸éœ€è¦æ¯æ¬¡è¯·æ±‚éƒ½è¿›è¡Œæ–‡ä»¶çš„è¯»å–ï¼Œå¯ä»¥ä¼˜åŒ–é¦–å±æ¸²æŸ“æ—¶é—´å’ŒæœåŠ¡å™¨èµ„æºæ¶ˆè€—ã€‚</p><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">createServer</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:http</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">// é¿å…é‡å¤è¯»å–htmlæ¨¡æ¿</span></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> TemplatePath </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">fileURLToPath</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">new</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">URL</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">../index.html</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">meta</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">url))</span></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> template </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">readFile</span><span style="color: #EEFFFF">(TemplatePath</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #EEFFFF"> </span><span style="color: #F07178">encoding</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">utf-8</span><span style="color: #89DDFF">&#39;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> component </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">h</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">h1</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">Hello World!</span><span style="color: #89DDFF">&#39;</span><span style="color: #EEFFFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #82AAFF">startServer</span><span style="color: #EEFFFF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">/** </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">desc</span><span style="color: #546E7A; font-style: italic"> å¯åŠ¨æœåŠ¡å™¨ */</span></span>
<span class="line"><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">startServer</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">server</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">createServer</span><span style="color: #F07178">(</span><span style="color: #C792EA">async</span><span style="color: #F07178"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">req</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF; font-style: italic">res</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">page</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #F07178"> </span><span style="color: #82AAFF">render</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">component</span><span style="color: #F07178">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">end</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">page</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF">}</span><span style="color: #F07178">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #EEFFFF">server</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">listen</span><span style="color: #F07178">(</span><span style="color: #F78C6C">4936</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">()</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">log</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">Listening http://localhost:4936</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">))</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #EEFFFF">server</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">on</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">error</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">e</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #EEFFFF">e</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">code</span><span style="color: #F07178"> </span><span style="color: #89DDFF">===</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">EADDRINUSE</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&amp;&amp;</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">error</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">port: 4936 is used</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF">}</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">async</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">render</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">root</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #546E7A; font-style: italic">/* ... */</span><span style="color: #89DDFF">}</span></span></code></pre>
</code></pre><p class="paragraph">æ­¤æ—¶æµè§ˆå™¨è®¿é—®<code class="inline-code">localhost:4936</code>å³å¯çœ‹åˆ°<code class="inline-code">Hello World!</code>
<a name="MwzDL"></a></p>
          <h2 id="%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%BF%80%E6%B4%BB" class="header h2">
            <a name="å®¢æˆ·ç«¯æ¿€æ´»" data-level="2" class="anchor" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%BF%80%E6%B4%BB">
              <span class="header-link">#</span>
            </a>
            å®¢æˆ·ç«¯æ¿€æ´»
          </h2><p class="paragraph"><a name="jN0nS"></a></p>
          <h3 id="%E8%AE%A1%E6%95%B0%E5%99%A8%E7%BB%84%E4%BB%B6" class="header h3">
            <a name="è®¡æ•°å™¨ç»„ä»¶" data-level="3" class="anchor" href="#%E8%AE%A1%E6%95%B0%E5%99%A8%E7%BB%84%E4%BB%B6">
              <span class="header-link">#</span>
            </a>
            è®¡æ•°å™¨ç»„ä»¶
          </h3><p class="paragraph">ç°åœ¨æˆ‘ä»¬çš„é¡µé¢æœ‰<code class="inline-code">html</code>å…ƒç´ ï¼Œæ²¡æœ‰<code class="inline-code">css</code>æˆ–<code class="inline-code">js</code>ã€‚æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«çŠ¶æ€å’Œäº‹ä»¶çš„è®¡æ•°å™¨ç»„ä»¶ã€‚</p><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">defineComponent</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">h</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">ref</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">vue</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> Counter </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">defineComponent</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">count</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">ref</span><span style="color: #F07178">(</span><span style="color: #F78C6C">0</span><span style="color: #F07178">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">function</span><span style="color: #F07178"> </span><span style="color: #82AAFF">handleAdd</span><span style="color: #89DDFF">()</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #EEFFFF">count</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">value</span><span style="color: #89DDFF">++</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">log</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">add</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">count</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">value</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #F07178"> </span><span style="color: #89DDFF">()</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #82AAFF">h</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">div</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> [</span></span>
<span class="line"><span style="color: #F07178">      </span><span style="color: #82AAFF">h</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">p</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">`</span><span style="color: #C3E88D">count: </span><span style="color: #89DDFF">${</span><span style="color: #EEFFFF">count</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">value</span><span style="color: #89DDFF">}`</span><span style="color: #F07178">)</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">      </span><span style="color: #82AAFF">h</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">button</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> onClick</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">handleAdd</span><span style="color: #F07178"> </span><span style="color: #89DDFF">},</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">Add</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">    ])</span></span>
<span class="line"><span style="color: #89DDFF">}</span><span style="color: #EEFFFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">export</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">default</span><span style="color: #EEFFFF"> Counter</span></span>
<span class="line"></span></code></pre>
</code></pre><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #546E7A; font-style: italic">// import ...</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> Counter </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">./App.js</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> component </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">h</span><span style="color: #EEFFFF">(Counter)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #82AAFF">startServer</span><span style="color: #EEFFFF">()</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic">/** </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">desc</span><span style="color: #546E7A; font-style: italic"> å¯åŠ¨æœåŠ¡å™¨ */</span></span>
<span class="line"><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">startServer</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #546E7A; font-style: italic">/* ... */</span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">/** </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">desc</span><span style="color: #546E7A; font-style: italic"> æ¸²æŸ“å¹¶æ‹¼æ¥HTML */</span></span>
<span class="line"><span style="color: #C792EA">async</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">render</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">root</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #546E7A; font-style: italic">/* ... */</span><span style="color: #89DDFF">}</span></span></code></pre>
</code></pre><p class="paragraph">ç°åœ¨å°†<code class="inline-code">entry-server.js</code>ä¸­æ¸²æŸ“çš„ç»„ä»¶æ”¹ä¸ºè®¡æ•°å™¨ç»„ä»¶åå†æ¬¡é‡å¯æœåŠ¡ç«¯ï¼ˆæ³¨æ„è¿™é‡Œç”±äºç›®å‰æ˜¯ç›´æ¥ç»™<code class="inline-code">Node.js</code>è¿è¡Œçš„<code class="inline-code">esm</code>æ¨¡å—ï¼Œæ‰€ä»¥åœ¨å¯¼å…¥æ¨¡å—æ—¶éœ€è¦æ·»åŠ æ–‡ä»¶åç¼€ï¼‰ï¼Œæ‰“å¼€æµè§ˆå™¨æ‰“å¼€<code class="inline-code">localhost:4936</code>å¯ä»¥çœ‹åˆ°é¡µé¢å·²ç»æ­£å¸¸æ¸²æŸ“äº†ï¼Œä½†ç‚¹å‡»æŒ‰é’®å´æ²¡æœ‰ä»»ä½•æ•ˆæœã€‚
<a name="XS1hG"></a></p>
          <h3 id="Hydration" class="header h3">
            <a name="Hydration" data-level="3" class="anchor" href="#Hydration">
              <span class="header-link">#</span>
            </a>
            Hydration
          </h3><p class="paragraph">ç°åœ¨æˆ‘ä»¬éœ€è¦ç»™å®¢æˆ·ç«¯çš„é™æ€é¡µé¢ç»‘å®šäº‹ä»¶ï¼Œå’Œå“åº”å¼æ•°æ®ï¼Œè¿™ä¸€æ­¥å®˜æ–¹ç§°ä¸ºæ³¨æ°´æˆ–å®¢æˆ·ç«¯æ¿€æ´»(<code class="inline-code">hydration</code>)ã€‚å½“ç„¶æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨å®¢æˆ·ç«¯ä½¿ç”¨<code class="inline-code">createApp</code>é‡æ–°æ¸²æŸ“ä¸€ä¸ª<code class="inline-code">CSR</code>åº”ç”¨ï¼Œä¸è¿‡<code class="inline-code">Vue</code>æä¾›äº†<code class="inline-code">createSSRApp</code>æ–¹æ³•ä¸“é—¨ç”¨äºå®¢æˆ·ç«¯æ¿€æ´»ï¼ŒåŒ<code class="inline-code">createApp</code>ä¸€æ ·ä¼šè¿”å›ä¸€ä¸ªåŒ…å«<code class="inline-code">mount</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯æŒ‚è½½åˆ°åº”ç”¨çš„æ ¹å…ƒç´ ä¸Šã€‚æˆ‘ä»¬å°†é»˜è®¤å¯¼å‡ºæ”¹ä¸ºä½¿ç”¨<code class="inline-code">createSSRApp</code>åˆ›å»ºåº”ç”¨å®ä¾‹è€Œä¸æ˜¯ç›´æ¥å¯¼å‡ºç»„ä»¶ã€‚</p><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">createSSRApp</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">defineComponent</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">h</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">ref</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">vue</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> Counter </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">defineComponent</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #546E7A; font-style: italic">/* ... */</span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">export</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">default</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">createSSRApp</span><span style="color: #EEFFFF">(Counter)</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">åˆ›å»ºéœ€è¦åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„æ¿€æ´»å‡½æ•°ã€‚</p><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> createApp </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">./App</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #82AAFF">startHydration</span><span style="color: #EEFFFF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">/** </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">desc</span><span style="color: #546E7A; font-style: italic"> åŸºäºæœåŠ¡ç«¯æ¸²æŸ“çš„é™æ€é¡µé›†æˆVueäº‹ä»¶ç»‘å®šï¼Œå“åº”å¼çŠ¶æ€ç­‰ */</span></span>
<span class="line"><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">startHydration</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">app</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">createApp</span><span style="color: #F07178">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">mount</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">#app</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">log</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">hydration success</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">æˆ‘ä»¬è¿˜éœ€è¦æ‰“åŒ…ä¸€ä¸‹<code class="inline-code">entry-client.js</code>å°†<code class="inline-code">vue</code>æ‰“åŒ…å…¥è¯¥æ–‡ä»¶ï¼Œå½“ç„¶ä½¿ç”¨<code class="inline-code">CDN</code>çš„æ–¹å¼å¯¼å…¥ä¹Ÿå¯ä»¥ã€‚è¿™é‡Œä½¿ç”¨<code class="inline-code">esbuild</code>æ‰“åŒ…ã€‚</p><pre><code class="language-bash"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #FFCB6B">pnpm</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">i</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">esbuild</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">-D</span></span></code></pre>
</code></pre><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">build</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">esbuild</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">resolve</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:path</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">fileURLToPath</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:url</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #82AAFF">buildEntryClient</span><span style="color: #EEFFFF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">buildEntryClient</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">RootDir</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">fileURLToPath</span><span style="color: #F07178">(</span><span style="color: #89DDFF">new</span><span style="color: #F07178"> </span><span style="color: #82AAFF">URL</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">..</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">meta</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">url</span><span style="color: #F07178">))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #82AAFF">build</span><span style="color: #F07178">(</span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">    bundle</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #FF9CAC">true</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">    format</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">esm</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">    target</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> [</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">es2022</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">]</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">    platform</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">browser</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">    entryPoints</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> [</span><span style="color: #82AAFF">resolve</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">RootDir</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">src/entry-client.js</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">)]</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">    outfile</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #82AAFF">resolve</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">RootDir</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">dist/entry-client.js</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">    define</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">      </span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">process.env.NODE_ENV</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">&quot;production&quot;</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">      __VUE_PROD_DEVTOOLS__</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">false</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">      __VUE_OPTIONS_API__</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">false</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF">}</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">æ·»åŠ ä¸€ä¸‹<code class="inline-code">package.json</code>çš„è„šæœ¬,æ‰§è¡Œä¸€ä¸‹<code class="inline-code">pnpm build:client</code>å³å¯çœ‹åˆ°å·²ç»å°†<code class="inline-code">entry-client.js</code>æ‰“åŒ…åœ¨<code class="inline-code">dist</code>ç›®å½•ä¸‹äº†ã€‚</p><pre><code class="language-json"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">type</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">module</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">scripts</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">build:client</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">node ./scripts/build.js</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">dev:server</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">pnpm build:client &amp;&amp; node ./src/entry-server.js</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">dependencies</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">vue</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">^3.3.7</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">devDependencies</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">@types/node</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">^20.8.8</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">esbuild</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">^0.19.5</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph"><a name="CsPbf"></a></p>
          <h2 id="%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%9C%8D%E5%8A%A1" class="header h2">
            <a name="é™æ€èµ„æºæœåŠ¡" data-level="2" class="anchor" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%9C%8D%E5%8A%A1">
              <span class="header-link">#</span>
            </a>
            é™æ€èµ„æºæœåŠ¡
          </h2><p class="paragraph"><a name="ISqeV"></a></p>
          <h3 id="%E5%BC%95%E5%85%A5%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6" class="header h3">
            <a name="å¼•å…¥å®¢æˆ·ç«¯å…¥å£æ–‡ä»¶" data-level="3" class="anchor" href="#%E5%BC%95%E5%85%A5%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6">
              <span class="header-link">#</span>
            </a>
            å¼•å…¥å®¢æˆ·ç«¯å…¥å£æ–‡ä»¶
          </h3><p class="paragraph">ç°åœ¨åœ¨æˆ‘ä»¬çš„<code class="inline-code">index.html</code>ä¸­å¼•å…¥å®¢æˆ·ç«¯æ¿€æ´»è„šæœ¬<code class="inline-code">dist/entry-client.js</code>ï¼Œè®°å¾—è¦åœ¨<code class="inline-code">script</code>æ ‡ç­¾ä¸Šæ·»åŠ <code class="inline-code">type=&quot;module&quot;</code>æˆ–<code class="inline-code">defer</code>å±æ€§ï¼Œæˆ–è€…å°†å…¶ç§»åˆ°<code class="inline-code">div#app</code>å…ƒç´ ä¸‹æ–¹ (ç¡®ä¿<code class="inline-code">app.mount(&#39;#app&#39;)</code>è„šæœ¬è¿è¡Œæ—¶å…ƒç´ å·²ç»å­˜åœ¨)ã€‚</p><p class="paragraph">é¡ºå¸¦ä¸€ç¬”ï¼Œåˆšå¼€å§‹æ‰“ç®—ç›´æ¥æŠŠ<code class="inline-code">dist/entry-client.js</code>ä¸­çš„å†…å®¹æ‹¼æ¥åˆ°<code class="inline-code">html</code>çš„<code class="inline-code">script</code>æ ‡ç­¾å†…ï¼Œä½†è¿™åŠ å¤§äº†ç½‘é¡µçˆ¬è™«çš„åŠ è½½æ—¶é—´ï¼Œè‹¥æ‹¼æ¥åœ¨<code class="inline-code">html</code>å†…ï¼Œåˆ™ä½¿ç”¨<code class="inline-code">curl</code>è®¿é—®æ—¶ä¼šå°†<code class="inline-code">javascript</code>æ–‡ä»¶ä¹Ÿæ‹‰ä¸‹æ¥ï¼Œè€Œé€šè¿‡<code class="inline-code">script</code>çš„<code class="inline-code">src</code>æ–¹å¼å¯¼å…¥åˆ™åªä»…ä¼šæ˜¾ç¤ºä¸€ä¸ªæ ‡ç­¾ï¼Œçˆ¬è™«å¯ä»¥æ›´å¿«çš„è·å–åˆ°é¡µé¢ã€‚</p><p class="paragraph">ä½†ç›¸åº”çš„å®¢æˆ·ç«¯å°±è¦å†æ¬¡å‘èµ·è¯·æ±‚è·å–<code class="inline-code">js</code>äº†ï¼Œåœ¨è¯·æ±‚<code class="inline-code">js</code>æœŸé—´ä¸èƒ½å¤„ç†é¡µé¢çš„ç”¨æˆ·äº‹ä»¶(åœ¨æ…¢é€Ÿ<code class="inline-code">3G</code>çš„ç½‘ç»œä¸‹æ…¢äº†2så·¦å³ï¼Œä½†å¯¹äºçˆ¬è™«å®Œæˆ<code class="inline-code">html</code>è¯·æ±‚å¿«äº†3.7så·¦å³)ã€‚<br /><img src="https://cdn.nlark.com/yuque/0/2023/png/22950541/1698245454593-02c68d34-c77a-4d7d-bf8c-ed9f855ecefb.png#averageHue=%23f5f4f3&clientId=uf901401a-2be9-4&from=paste&height=260&id=ua72f78ce&originHeight=325&originWidth=1198&originalType=binary&ratio=1.25&rotation=0&showTitle=true&size=47243&status=done&style=none&taskId=u260ee234-d8bb-424c-a63a-22b8d494946&title=%E4%BD%BF%E7%94%A8script%20src%E5%B1%9E%E6%80%A7%E5%8A%A0%E8%BD%BD&width=958.4" alt="ä½¿ç”¨script srcå±æ€§åŠ è½½" title="ä½¿ç”¨script srcå±æ€§åŠ è½½"><br /><img src="https://cdn.nlark.com/yuque/0/2023/png/22950541/1698245459157-4129c85e-d995-4d98-b811-24a9553f302a.png#averageHue=%23f5f4f3&clientId=uf901401a-2be9-4&from=paste&height=235&id=u06fe5d71&originHeight=294&originWidth=1200&originalType=binary&ratio=1.25&rotation=0&showTitle=true&size=42753&status=done&style=none&taskId=u68ee15dc-ab5e-4c06-8760-ce926012ebe&title=%E4%BD%BF%E7%94%A8%E5%86%85%E8%81%94%E7%9A%84script%E6%A0%87%E7%AD%BE&width=960" alt="ä½¿ç”¨å†…è”çš„scriptæ ‡ç­¾" title="ä½¿ç”¨å†…è”çš„scriptæ ‡ç­¾"></p><pre><code class="language-html"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF">&lt;!</span><span style="color: #F07178">DOCTYPE</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">html</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">html</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">lang</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">zh</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">head</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">meta</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">charset</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">UTF-8</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> /&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">meta</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">name</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">viewport</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">content</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">width=device-width, initial-scale=1.0</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> /&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">title</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">Mini SSR</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">title</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">    &lt;</span><span style="color: #F07178">script</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">type</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">module</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">dist/entry-client.js</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> &gt;&lt;/</span><span style="color: #F07178">script</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">head</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">div</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">id</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">app</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span><span style="color: #546E7A; font-style: italic">&lt;!-- App Slot --&gt;</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">div</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">html</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">æµè§ˆå™¨ä¼šè¯·æ±‚é™æ€èµ„æºï¼Œæ­¤æ—¶å°±éœ€è¦åœ¨æœåŠ¡ç«¯å¤„ç†é™æ€èµ„æºè¯·æ±‚æœåŠ¡ï¼Œè‹¥è¯·æ±‚è·¯å¾„å­˜åœ¨åç¼€åˆ™åˆ¤å®šä¸ºè¯·æ±‚é™æ€èµ„æºï¼Œå¦åˆ™è¿”å›æœåŠ¡ç«¯æ¸²æŸ“ç•Œé¢ã€‚è‡³æ­¤å°±å®Œæˆäº†åŸºæœ¬çš„æœåŠ¡ç«¯æ¸²æŸ“äº†ï¼Œæµè§ˆå™¨æ‰“å¼€<code class="inline-code">localhost:4936</code>è®¡æ•°å™¨æ­£å¸¸æ¸²æŸ“ï¼Œå¹¶ä¸”<code class="inline-code">vue</code>ä¹Ÿä¸å®¢æˆ·ç«¯<code class="inline-code">DOM</code>ç»‘å®šäº†å“åº”å¼æ•°æ®ã€‚</p><p class="paragraph">ä½¿ç”¨<code class="inline-code">createSSRApp</code>å‡½æ•°åˆ›å»ºçš„å®ä¾‹ä¸åº”è¯¥è¢«é‡å¤ä½¿ç”¨ï¼Œè€Œåº”åœ¨æ¯æ¬¡å“åº”æ—¶éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå¦åˆ™åœ¨ç¬¬äºŒæ¬¡è¯·æ±‚æ—¶æœåŠ¡ç«¯æ§åˆ¶å°ä¼šå‘å‡ºå¦‚ä¸‹è­¦å‘Šï¼š<br /><code class="inline-code">[Vue warn]: App already provides property with key &quot;Symbol(v-scx)&quot;. It will be overwritten with the new value.</code><br />è‹¥è¿˜ä½¿ç”¨äº†è·¯ç”±ä¸çŠ¶æ€ç®¡ç†æ’ä»¶åˆ™å¯èƒ½ä¼šå½±å“ä¸åŒè¯·æ±‚çš„æ¸²æŸ“ç»“æœï¼ˆå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://cn.vuejs.org/guide/scaling-up/ssr.html#cross-request-state-pollution" title="null" class="link">è·¨è¯·æ±‚çŠ¶æ€æ±¡æŸ“</a>ï¼‰ã€‚</p><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">renderToString</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">vue/server-renderer</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">readFile</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">stat</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:fs/promises</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">createReadStream</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:fs</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">fileURLToPath</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:url</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">createServer</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:http</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">extname</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:path</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> createApp </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">./App.js</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> TemplatePath </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">fileURLToPath</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">new</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">URL</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">../index.html</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">meta</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">url))</span></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> template </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">readFile</span><span style="color: #EEFFFF">(TemplatePath</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #EEFFFF"> </span><span style="color: #F07178">encoding</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">utf-8</span><span style="color: #89DDFF">&#39;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">// const app = createApp()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #82AAFF">startServer</span><span style="color: #EEFFFF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">/** </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">desc</span><span style="color: #546E7A; font-style: italic"> å¯åŠ¨æœåŠ¡å™¨ */</span></span>
<span class="line"><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">startServer</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">server</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">createServer</span><span style="color: #F07178">(</span><span style="color: #C792EA">async</span><span style="color: #F07178"> </span><span style="color: #89DDFF">({</span><span style="color: #F07178"> </span><span style="color: #EEFFFF; font-style: italic">url</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">},</span><span style="color: #F07178"> </span><span style="color: #EEFFFF; font-style: italic">res</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #F07178"> (</span><span style="color: #82AAFF">extname</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">url</span><span style="color: #F07178">) </span><span style="color: #89DDFF">!==</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;&#39;</span><span style="color: #F07178">) </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">      </span><span style="color: #82AAFF">staticService</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">url</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">res</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #89DDFF">}</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">else</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">      </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">app</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">createApp</span><span style="color: #F07178">()</span></span>
<span class="line"><span style="color: #F07178">      </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">page</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #F07178"> </span><span style="color: #82AAFF">render</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">app</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">      </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">end</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">page</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF">}</span><span style="color: #F07178">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #EEFFFF">server</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">listen</span><span style="color: #F07178">(</span><span style="color: #F78C6C">4936</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">()</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">log</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">Listening http://localhost:4936</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">))</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #EEFFFF">server</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">on</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">error</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">e</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #89DDFF">    </span><span style="color: #546E7A; font-style: italic">// @ts-ignore</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #EEFFFF">e</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">code</span><span style="color: #F07178"> </span><span style="color: #89DDFF">===</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">EADDRINUSE</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&amp;&amp;</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">error</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">port: 4936 is used</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF">}</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">/**</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic"> * </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">param</span><span style="color: #546E7A; font-style: italic"> </span><span style="color: #89DDFF; font-style: italic">{</span><span style="color: #FFCB6B; font-style: italic">import(&#39;vue&#39;).App&lt;any&gt; | import(&#39;vue&#39;).VNode</span><span style="color: #89DDFF; font-style: italic">}</span><span style="color: #546E7A; font-style: italic"> </span><span style="color: #EEFFFF; font-style: italic">root</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic"> * </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">returns</span><span style="color: #546E7A; font-style: italic"> </span><span style="color: #89DDFF; font-style: italic">{</span><span style="color: #FFCB6B; font-style: italic">Promise&lt;string&gt;</span><span style="color: #89DDFF; font-style: italic">}</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic"> */</span></span>
<span class="line"><span style="color: #C792EA">async</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">render</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">root</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #546E7A; font-style: italic">/* ... */</span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">/**</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic"> * </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">desc</span><span style="color: #546E7A; font-style: italic"> é™æ€èµ„æºæœåŠ¡</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic"> * </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">param</span><span style="color: #546E7A; font-style: italic"> </span><span style="color: #89DDFF; font-style: italic">{</span><span style="color: #FFCB6B; font-style: italic">string</span><span style="color: #89DDFF; font-style: italic">}</span><span style="color: #546E7A; font-style: italic"> </span><span style="color: #EEFFFF; font-style: italic">filePath</span><span style="color: #546E7A; font-style: italic"> æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic"> * </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">param</span><span style="color: #546E7A; font-style: italic"> </span><span style="color: #89DDFF; font-style: italic">{</span><span style="color: #FFCB6B; font-style: italic">import(&#39;node:http&#39;).ServerResponse</span><span style="color: #89DDFF; font-style: italic">}</span><span style="color: #546E7A; font-style: italic"> </span><span style="color: #EEFFFF; font-style: italic">res</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic"> */</span></span>
<span class="line"><span style="color: #C792EA">async</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">staticService</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">filePath</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #EEFFFF; font-style: italic">res</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #EEFFFF">filePath</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">fileURLToPath</span><span style="color: #F07178">(</span><span style="color: #89DDFF">new</span><span style="color: #F07178"> </span><span style="color: #82AAFF">URL</span><span style="color: #F07178">(</span><span style="color: #89DDFF">`</span><span style="color: #C3E88D">..</span><span style="color: #89DDFF">${</span><span style="color: #EEFFFF">filePath</span><span style="color: #89DDFF">}`</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">meta</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">url</span><span style="color: #F07178">))</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">extension</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">extname</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">filePath</span><span style="color: #F07178">)</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">slice</span><span style="color: #F07178">(</span><span style="color: #F78C6C">1</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">contentType</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">      html</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">text/html;charset=UTF-8</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">      js</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">text/javascript;charset=UTF-8</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">      css</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">text/css;charset=UTF-8</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">      png</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">image/png</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">      jpg</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">image/jpeg</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">      json</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">application/json;charset=UTF-8</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">      ico</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">image/x-icon</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">      svg</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">image/svg+xml</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #89DDFF">}</span><span style="color: #F07178">[</span><span style="color: #EEFFFF">extension</span><span style="color: #F07178">] </span><span style="color: #89DDFF">??</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">text/plain;charset=UTF-8</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF; font-style: italic">try</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">fileStat</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #F07178"> </span><span style="color: #82AAFF">stat</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">filePath</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">fileStat</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">isFile</span><span style="color: #F07178">()) </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">      </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">statusCode</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #F78C6C">200</span></span>
<span class="line"><span style="color: #F07178">      </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">setHeader</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">Content-Type</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">contentType</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">      </span><span style="color: #82AAFF">createReadStream</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">filePath</span><span style="color: #F07178">)</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">pipe</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">res</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF">}</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">catch</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">e</span><span style="color: #F07178">) </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">statusCode</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #F78C6C">404</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">end</span><span style="color: #F07178">()</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</code></pre><p class="paragraph"><a name="wXux4"></a></p>
          <h3 id="CSS%E4%B8%8E%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90" class="header h3">
            <a name="CSSä¸å›¾ç‰‡èµ„æº" data-level="3" class="anchor" href="#CSS%E4%B8%8E%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90">
              <span class="header-link">#</span>
            </a>
            CSSä¸å›¾ç‰‡èµ„æº
          </h3><p class="paragraph">åŸå…ˆæ‰“ç®—ä¸ºäº†è½»é‡è€Œä¸ä½¿ç”¨<code class="inline-code">vite</code>çš„ï¼Œä½†<code class="inline-code">esbuild</code>çš„<code class="inline-code">css</code>æ‰“åŒ…<code class="inline-code">spliting</code>é€‰é¡¹åŠŸèƒ½å¤ªå°‘äº†ï¼Œè€Œä¸”ä¼šåœ¨æ¯ä¸ªå¼•å…¥æœ‰<code class="inline-code">css</code>çš„ç»„ä»¶çš„æ–‡ä»¶å¤„éƒ½ç”Ÿæˆä¸€ä»½æ ·å¼æ–‡ä»¶ä½¿æ‰“åŒ…ç»“æœæ¯”è¾ƒæ··ä¹±ï¼Œåœ¨æ‰“åŒ…åç”Ÿæˆçš„<code class="inline-code">metafile</code>ä¸­ä¹Ÿéš¾ä»¥ç²¾ç¡®çš„çŸ¥é“æ˜¯å“ªä¸ªç»„ä»¶éœ€è¦æ ·å¼æ–‡ä»¶åªèƒ½å…¨å±€å¼•å…¥ã€‚</p><p class="paragraph">è€Œ<code class="inline-code">rollup</code>æˆ–<code class="inline-code">rspack</code>æš‚æ—¶ä¸èƒ½å¼€ç®±å³ç”¨éœ€è¦ä¸€äº›æ’ä»¶æ”¯æŒï¼Œæ‰€ä»¥è¿˜æ˜¯å†³å®šä½¿ç”¨<code class="inline-code">vite</code>æ¥è¿›è¡Œæ‰“åŒ…ï¼Œæ‰€ä»¥ï¼Œç°åœ¨<code class="inline-code">css</code>ä¸å›¾ç‰‡èµ„æºä¸ä½¿ç”¨<code class="inline-code">vite</code>çš„åº”ç”¨ä¸€æ ·äº†éƒ½ç”±<code class="inline-code">vite</code>æ¥æ‰˜ç®¡äº†ğŸ˜…(åŒ…æ‹¬åŠ¨æ€çš„å¯¼å…¥æ‰€éœ€çš„é™æ€èµ„æºä¹Ÿå·²ç»è‡ªåŠ¨æ³¨å…¥äº†<code class="inline-code">profill</code>ä¸<code class="inline-code">vitePreload</code>å‡½æ•°æ¥å¤„ç†ï¼Œè¿™å°±æ˜¯å¼€ç®±å³ç”¨çš„é­…åŠ›å§)ã€‚<code class="inline-code">vite</code>æœåŠ¡ç«¯çƒ­æ›´æ–°åœ¨å®˜ç½‘æ–‡æ¡£æœ‰ä»‹ç»ï¼Œè¿™é‡Œå…ˆåªå…³æ³¨äºæœåŠ¡ç«¯æ¸²æŸ“çš„å®ç°ï¼Œæ‰€ä»¥æ²¡æœ‰å¤„ç†å¼€å‘ç¯å¢ƒï¼Œåªå¤„ç†ç”Ÿäº§ç¯å¢ƒï¼Œéœ€è¦æ‰“åŒ…åå†é¢„è§ˆã€‚</p><pre><code class="language-bash"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #FFCB6B">pnpm</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">i</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">vite</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">-D</span></span>
<span class="line"><span style="color: #FFCB6B">pnpm</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">rm</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">esbuild</span><span style="color: #EEFFFF"> </span><span style="color: #C3E88D">-D</span></span></code></pre>
</code></pre><p class="paragraph">ä¸‹é¢æ˜¯<code class="inline-code">vite</code>å®¢æˆ·ç«¯æ‰“åŒ…é…ç½®ï¼Œä¸ºäº†æ–¹ä¾¿ä»“åº“æ‰“åŒ…äº§ç‰©ï¼Œè¿™é‡ŒæŠŠ<code class="inline-code">target</code>è®¾ä¸º<code class="inline-code">es2022</code>å¹¶å…³é—­äº§ç‰©å‹ç¼©ã€‚</p><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">defineConfig</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">vite</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">export</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">default</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">defineConfig</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #F07178">base</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">./</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #F07178">build</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #F07178">target</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> [</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">es2022</span><span style="color: #89DDFF">&#39;</span><span style="color: #EEFFFF">]</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #F07178">minify</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #FF9CAC">false</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #F07178">css</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #F07178">modules</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">      </span><span style="color: #F07178">localsConvention</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">camelCase</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">      </span><span style="color: #F07178">scopeBehaviour</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">local</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">      </span><span style="color: #F07178">generateScopedName</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">[name]_[local]_[hash:5]</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #89DDFF">}</span><span style="color: #EEFFFF">)</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">å°†<code class="inline-code">html</code>å¼•å…¥çš„æ–‡ä»¶æ”¹ä¸º<code class="inline-code">src/entry-client</code>ç”±<code class="inline-code">vite</code>æ§åˆ¶æ‰“åŒ…åçš„èµ„æºè¯·æ±‚ç›®å½•ã€‚</p><pre><code class="language-html"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF">&lt;!</span><span style="color: #F07178">DOCTYPE</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">html</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">html</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">lang</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">zh</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">head</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #546E7A; font-style: italic">&lt;!-- ... --&gt;</span></span>
<span class="line"><span style="color: #89DDFF">    &lt;</span><span style="color: #F07178">script</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">type</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">module</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">src/entry-client.js</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> &gt;&lt;/</span><span style="color: #F07178">script</span><span style="color: #89DDFF">&gt;    </span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #546E7A; font-style: italic">&lt;!-- Head Slot --&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">head</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">div</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">id</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">app</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span><span style="color: #546E7A; font-style: italic">&lt;!-- App Slot --&gt;</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">div</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">html</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">ç”±äº<code class="inline-code">node.js</code>å¼•å…¥<code class="inline-code">esm</code>éœ€è¦æ·»åŠ é¢å¤–çš„<code class="inline-code">.js</code>åç¼€å¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥å¯¹<code class="inline-code">entry-server.js</code>ä¹Ÿè¿›è¡Œæ‰“åŒ…å¤„ç†ã€‚æ–°å»ºä¸€ä¸ªå•ç‹¬çš„<code class="inline-code">vite</code>é…ç½®æ–‡ä»¶ç”¨äºæ‰“åŒ…æœåŠ¡ç«¯å…¥å£æ–‡ä»¶ï¼Œå°†æ‰“åŒ…äº§ç‰©æ”¾åˆ°<code class="inline-code">dist/server</code>ç›®å½•ä¸‹ï¼Œå¦‚æ­¤<code class="inline-code">entry-server.js</code>ä¸ HTML ç›®æ ‡çš„ç›¸å¯¹ä½ç½®ä¸æºç ç›®å½•ä¸€è‡´ã€‚</p><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> clientConfig </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">./vite.config</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">defineConfig</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">mergeConfig</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">vite</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">export</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">default</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">mergeConfig</span><span style="color: #EEFFFF">(</span></span>
<span class="line"><span style="color: #EEFFFF">  clientConfig</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #82AAFF">defineConfig</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #F07178">build</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">      </span><span style="color: #F07178">outDir</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">dist/server</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">      </span><span style="color: #F07178">ssr</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">src/entry-server.js</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">      </span><span style="color: #F07178">ssrManifest</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #FF9CAC">true</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF">)</span></span>
<span class="line"><span style="color: #EEFFFF">)</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">é…ç½®ä¸€ä¸‹<code class="inline-code">package.json</code>è„šæœ¬, <strong class="strong">æ³¨æ„è¦å…ˆæ‰“åŒ…</strong><code class="inline-code">**client**</code><strong class="strong">,å†æ‰“åŒ…</strong><code class="inline-code">**server**</code><strong class="strong">å¦åˆ™</strong><code class="inline-code">**vite**</code><strong class="strong">ä¼šåœ¨ç”Ÿæˆå®¢æˆ·ç«¯æ‰“åŒ…äº§ç‰©æ—¶æŠŠ dist ä¸­çš„æ‰“åŒ…</strong><code class="inline-code">**server**</code><strong class="strong">ç›®å½•æ¸…ç©º</strong></p><pre><code class="language-json"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">type</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">module</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">scripts</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">build</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">pnpm build:client &amp; pnpm build:server</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">build:client</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">vite build</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">build:server</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">vite build -c ./vite.config.server.js </span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">dev</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">pnpm build &amp;&amp; node ./dist/server/entry-server.js</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">preview</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">node ./dist/server/entry-server.js</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">dependencies</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">vue</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">^3.3.7</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">devDependencies</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">@types/node</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">^20.8.9</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #FFCB6B">vite</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">^4.5.0</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">é‡æ„ä¸€ä¸‹<code class="inline-code">entry-server.js</code>çš„ä»£ç å¯ä»¥æŠŠ<code class="inline-code">.js</code>åç¼€å»é™¤äº†ã€‚</p><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #546E7A; font-style: italic">// import ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">// å¯ä»¥æŠŠ `.js` åç¼€å»é™¤äº†</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> createApp </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">./App</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">// ...</span></span></code></pre>
</code></pre><p class="paragraph"><a name="bQDS8"></a></p>
          <h3 id="%E8%B5%84%E6%BA%90preload" class="header h3">
            <a name="èµ„æºpreload" data-level="3" class="anchor" href="#%E8%B5%84%E6%BA%90preload">
              <span class="header-link">#</span>
            </a>
            èµ„æºpreload
          </h3><p class="paragraph">è¯¥éƒ¨åˆ†ä¸æ‰“åŒ…å·¥å…·å…³è”æ€§è¾ƒå¼ºï¼Œ<code class="inline-code">vite</code>é»˜è®¤åœ¨å®¢æˆ·ç«¯æ‰“åŒ…äº§ç‰©ä¸­è‡ªåŠ¨æ·»åŠ <code class="inline-code">preload</code>ç›¸å…³çš„<code class="inline-code">js</code>ä»£ç ã€‚<br />ğŸš§WIP</p><p class="paragraph"><a name="gSUBL"></a></p>
          <h2 id="%E4%BC%98%E5%8C%96" class="header h2">
            <a name="ä¼˜åŒ–" data-level="2" class="anchor" href="#%E4%BC%98%E5%8C%96">
              <span class="header-link">#</span>
            </a>
            ä¼˜åŒ–
          </h2><p class="paragraph"><a name="ofSz5"></a></p>
          <h3 id="%E5%9F%BA%E4%BA%8ESSR%E9%A2%84%E6%B8%B2%E6%9F%93" class="header h3">
            <a name="åŸºäºSSRé¢„æ¸²æŸ“" data-level="3" class="anchor" href="#%E5%9F%BA%E4%BA%8ESSR%E9%A2%84%E6%B8%B2%E6%9F%93">
              <span class="header-link">#</span>
            </a>
            åŸºäºSSRé¢„æ¸²æŸ“
          </h3><p class="paragraph">å¯¹äºé•¿æ—¶é—´çš„ä¸ä¼šæ›´æ–°çš„è·¯ç”±å¯ä»¥åœ¨æ„å»ºé˜¶æ®µç›´æ¥ç”Ÿæˆ HTML åä¿å­˜ä¸ºé™æ€èµ„æºï¼ŒæœåŠ¡ç«¯åˆ¤å®šè·¯ç”±ä¸ºé¢„æ¸²æŸ“è·¯ç”±åˆ™ç›´æ¥è¿”å›å¯¹åº”çš„é™æ€èµ„æºï¼Œäº¦å¯ä½¿ç”¨ Nginx é…ç½®è·¯å¾„çš„è½¬å‘ã€‚<br />æ–°å»º<code class="inline-code">entry-prerender.js</code>ç”¨äºåœ¨æ„å»ºé˜¶æ®µå¯¹ç‰¹å®šè·¯ç”±é¢„æ¸²æŸ“ã€‚</p><pre><code class="language-javascript"><pre class="shiki material-theme" style="background-color: #263238" tabindex="0"><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">readFile</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:fs/promises</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">fileURLToPath</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">resolve</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">node:path</span><span style="color: #89DDFF">&#39;</span><span style="color: #EEFFFF"> </span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">render</span><span style="color: #F07178"> </span><span style="color: #89DDFF">}</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">./entry-server.js</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> distPath </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">fileURLToPath</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">new</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">URL</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">..</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">meta</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">url))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #546E7A; font-style: italic">/**</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic">    * </span><span style="color: #89DDFF; font-style: italic">@</span><span style="color: #C792EA; font-style: italic">params</span><span style="color: #546E7A; font-style: italic"> {string[]} éœ€è¦é¢„æ¸²æŸ“çš„è·¯ç”±</span></span>
<span class="line"><span style="color: #546E7A; font-style: italic">    */</span></span>
<span class="line"><span style="color: #C792EA">async</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">startPrerender</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">routes</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #EEFFFF">routes</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> [</span><span style="color: #89DDFF">...new</span><span style="color: #F07178"> </span><span style="color: #82AAFF">Set</span><span style="color: #F07178">(</span><span style="color: #89DDFF">...</span><span style="color: #EEFFFF">routes</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">map</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">cleanRouteMap</span><span style="color: #F07178">)]</span></span>
<span class="line"><span style="color: #F07178">  </span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #EEFFFF">routes</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">map</span><span style="color: #F07178">(</span><span style="color: #C792EA">async</span><span style="color: #F07178"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">route</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">path</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">routeToFilePath</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">route</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">page</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #F07178"> </span><span style="color: #82AAFF">render</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">route</span><span style="color: #F07178">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #82AAFF">writeFile</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">path</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">page</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF">}</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">function</span><span style="color: #F07178"> </span><span style="color: #82AAFF">cleanRouteMap</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF; font-style: italic">route</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #EEFFFF">route</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">route</span><span style="color: #F07178">[</span><span style="color: #F78C6C">0</span><span style="color: #F07178">] </span><span style="color: #89DDFF">===</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">?</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">route</span><span style="color: #F07178"> </span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">+</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">route</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">route</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">at</span><span style="color: #F07178">(</span><span style="color: #89DDFF">-</span><span style="color: #F78C6C">1</span><span style="color: #F07178">) </span><span style="color: #89DDFF">===</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">&#39;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">?</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">route</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">slice</span><span style="color: #F07178">(</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">-</span><span style="color: #F78C6C">1</span><span style="color: #F07178">) </span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">route</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span></code></pre>
</code></pre><p class="paragraph">ä½¿ç”¨åŸºäº <code class="inline-code">vite</code> çš„ build API è¿›è¡Œé™æ€èµ„æºçš„å‹ç¼©å¤„ç†ä¸ sitemap çš„ç”Ÿæˆã€‚
<a name="r5YYB"></a></p>
          <h3 id="%E7%BC%93%E5%AD%98%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93%E7%BB%93%E6%9E%9C" class="header h3">
            <a name="ç¼“å­˜æœåŠ¡ç«¯æ¸²æŸ“ç»“æœ" data-level="3" class="anchor" href="#%E7%BC%93%E5%AD%98%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93%E7%BB%93%E6%9E%9C">
              <span class="header-link">#</span>
            </a>
            ç¼“å­˜æœåŠ¡ç«¯æ¸²æŸ“ç»“æœ
          </h3><p class="paragraph">å¯¹æœåŠ¡ç«¯çš„æ¸²æŸ“ç»“æœè¿›è¡Œ
<a name="McfcZ"></a></p>
          <h3 id="Island" class="header h3">
            <a name="Island" data-level="3" class="anchor" href="#Island">
              <span class="header-link">#</span>
            </a>
            Island
          </h3><p class="paragraph"><a name="SjbSf"></a></p>
          <h2 id="%E5%8F%82%E8%80%83" class="header h2">
            <a name="å‚è€ƒ" data-level="2" class="anchor" href="#%E5%8F%82%E8%80%83">
              <span class="header-link">#</span>
            </a>
            å‚è€ƒ
          </h2><p class="paragraph"><a href="https://cn.vuejs.org/guide/scaling-up/ssr.html#server-side-rendering-ssr" title="null" class="link">æœåŠ¡ç«¯æ¸²æŸ“ (SSR) | Vue.js</a><br /><a href="https://v2.ssr.vuejs.org/zh/" title="null" class="link">Vue.js æœåŠ¡å™¨ç«¯æ¸²æŸ“æŒ‡å— | Vue SSR æŒ‡å—</a><br /><a href="https://pinia.vuejs.org/zh/ssr/" title="null" class="link">Pinia ğŸ</a><br /><a href="https://vitejs.dev/guide/ssr" title="null" class="link">Vite</a></p>
          </article>

          <section class="bg-primary-2 mt-4 pa-4 rounded-xl dark:bg-primary-7 line-height-6">
            <h3 class="mt-0">è¯„è®º</h3>
            <form id="comment" action="/api/comment" class="flex flex-col gap-4">
              <textarea
                id="comment-textarea"
                required
                placeholder="å†™ä¸‹ä½ çš„è¯„è®º (å‹å–„çš„è¯„è®ºæ˜¯äº¤æµçš„èµ·ç‚¹)"
                text="base primary-7 dark:primary-1"
                bg="primary-1/50 hover:primary-1 focus:primary-50 dark:primary-6/50 dark:hover:primary-6 dark:focus:primary-8"
                class="pa-2 resize-y h-20 transition-background-color scrollbar-slim rounded border-none focus-visible:outline-none"
              ></textarea>
              <div class="flex justify-between">
                <input
                  id="comment-nickname"
                  type="text"
                  required
                  placeholder="è¯·è¾“å…¥æ˜µç§°"
                  text="base primary-7 dark:primary-1"
                  bg="primary-1/50 hover:primary-1 focus:primary-50 dark:primary-6/50 dark:hover:primary-6 dark:focus:primary-8"
                  class="pa-1 transition-background-color rounded border-none focus-visible:outline-none"
                />
                <button
                  id="comment-submit"
                  type="button"
                  bg="hover:primary-4/50 active:primary-3 primary-3 dark:hover:primary-5/50 dark:active:primary-5 dark:primary-5"
                  class="ml-auto border-none rounded font-bold py-2 px-4 transition-background-color"
                >
                  æäº¤
                </button>
              </div>
            </form>

            <div id="comment-container" class="ml-2">
              <div class="flex items-start gap-4">
                <p class="flex flex-col items-center justify-center">
                  <span class="font-bold block h-4 w-10 bg-primary-3 dark:bg-primary-6 animate-paused"></span>
                </p>

                <p class="flex flex-1 flex-col bg-primary-3 dark:bg-primary-6 rounded pa-2 animate-paused">
                  <span class="block h-4"></span>
                  <span class="ml-auto text-sm block h-4 text-primary-5 dark:bg-primary-3"
                    ><time></time></span
                  >
                </p>
              </div>
            </div>
          </section>
        </main>
        <aside class="hidden md:block basis-72">
          <div class="sticky top-0">
            <nav>
              <ul>
                <li>11</li>
                <li>22</li>
                <li>33</li>
              </ul>
            </nav>
          </div>
        </aside>
      </div>
      <footer></footer>
    </div>
  </body>
</html>
